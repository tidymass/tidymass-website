<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: 2024年10月14日 --><html lang="zh-Hans" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.4b7280f12f476311af2218ec632c93a2.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Xiaotao Shen" />





  

<meta name="description" content="Data preparation After the raw data processing, peak tables for positive and negative mode have been generated.
Next, we need to get the peak table and sample information and organize them as mass_dataset class objects." />



  <link rel="alternate" hreflang="en" href="https://www.tidymass.org/docs/chapter5/1-data_explore/" />

<link rel="alternate" hreflang="zh-Hans" href="https://www.tidymass.org/zh/docs/chapter5/1-data_explore/" />
<link rel="canonical" href="https://www.tidymass.org/zh/docs/chapter5/1-data_explore/" />



  <link rel="manifest" href="/zh/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_huf8b049b8318691de0a515d87795ef728_130772_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_huf8b049b8318691de0a515d87795ef728_130772_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#EF525B" />










  
  






<meta property="twitter:card" content="summary" />

  <meta property="twitter:site" content="@wowchemy" />
  <meta property="twitter:creator" content="@wowchemy" />
<meta property="twitter:image" content="https://www.tidymass.org/media/icon_huf8b049b8318691de0a515d87795ef728_130772_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="TidyMass" />
<meta property="og:url" content="https://www.tidymass.org/zh/docs/chapter5/1-data_explore/" />
<meta property="og:title" content="Explore data | TidyMass" />
<meta property="og:description" content="Data preparation After the raw data processing, peak tables for positive and negative mode have been generated.
Next, we need to get the peak table and sample information and organize them as mass_dataset class objects." /><meta property="og:image" content="https://www.tidymass.org/media/icon_huf8b049b8318691de0a515d87795ef728_130772_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="zh-Hans" />

  
    <meta
      property="article:published_time"
      content="2019-05-05T00:00:00&#43;01:00"
    />
  
  
    <meta property="article:modified_time" content="2019-05-05T00:00:00&#43;01:00">
  







  




  
  
  

  
  

  


  
  <title>Explore data | TidyMass</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="d396ef5e42f9a4fa91294d10a31989a2" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.bc584d8639f6412fc553d13c23e02e8a.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>搜索</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜索...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/zh/">TidyMass</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="切换导航">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/zh/">TidyMass</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh/#hero"><span>主页</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh/#packages"><span>R包</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh/#team"><span>团队</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh/#contact"><span>联系</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/zh/#contribution"><span>贡献</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link  active" href="/zh/docs/"><span>文档</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        
        <li class="nav-item">
          <a class="nav-link js-search" href="#" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        
        
        
        <li class="nav-item dropdown theme-dropdown">
          <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
            <i class="fas fa-moon" aria-hidden="true"></i>
          </a>
          <div class="dropdown-menu">
            <a href="#" class="dropdown-item js-set-theme-light">
              <span>浅色</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-dark">
              <span>深色</span>
            </a>
            <a href="#" class="dropdown-item js-set-theme-auto">
              <span>自动</span>
            </a>
          </div>
        </li>
        

        
        
        <li class="nav-item dropdown i18n-dropdown">
          <a href="#" class="nav-link " data-toggle="dropdown"
             aria-haspopup="true" aria-label="语言">
            <i class="fas fa-globe mr-1" aria-hidden="true"></i></a>
          <div class="dropdown-menu">
            <div class="dropdown-item dropdown-item-active">
              <span>中文 (简体)</span>
            </div>
            
            <a class="dropdown-item" href="https://www.tidymass.org/docs/chapter5/1-data_explore/">
              <span>English</span>
            </a>
            
          </div>
        </li>
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    




<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <div class="d-flex">
      <span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">
        
        
          Chapter 5 Explore data
        
      </span>
      <span><i class="fas fa-chevron-down"></i></span>
    </div>
  </button>

  
  <button class="form-control sidebar-search js-search d-none d-md-flex">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">搜索...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/zh/docs/"><i class="fas fa-house pr-1"></i>Preface</a></li>
    
      


  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter1/"><i class="fas fa-book pr-1"></i>Chapter 1 Installation</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter1/1-installation/">1 Install tidymass</a></li>



  <li class=""><a href="/zh/docs/chapter1/2-update/">2 更新 tidymass</a></li>



  <li class=""><a href="/zh/docs/chapter1/3-docker_tidymass/">3 Docker 版本的 tidymass</a></li>



  <li class=""><a href="/zh/docs/chapter1/4-build_own_docker/">4 构建你自己的 docker</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter2/"><i class="fas fa-book-reader pr-1"></i>Chapter 2 massDataset package</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter2/1-create_mass_dataset/">1 Create mass_dataset class</a></li>



  <li class=""><a href="/zh/docs/chapter2/2-add_ms2/">2 Add MS2 spectra</a></li>



  <li class=""><a href="/zh/docs/chapter2/3-mass_dataset_other_tools/">3 Create mass_dataset class from other tools</a></li>



  <li class=""><a href="/zh/docs/chapter2/4-extract/">4 Extract data</a></li>



  <li class=""><a href="/zh/docs/chapter2/5-processing_information/">5 Processing information</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter3/"><i class="fas fa-book-reader pr-1"></i>Chapter 3 Data format converter</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter3/1-proteowizard/">1 proteowizard</a></li>



  <li class=""><a href="/zh/docs/chapter3/2-data_convert/">2 massconverter</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter4/"><i class="fas fa-book-reader pr-1"></i>Chapter 4 Raw data processing</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter4/1-raw_data_processing/">Raw data processing</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter5/"><i class="fas fa-book-reader pr-1"></i>Chapter 5 Explore data</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class="active"><a href="/zh/docs/chapter5/1-data_explore/">Explore data</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter6/"><i class="fas fa-book-reader pr-1"></i>Chapter 6 Data cleaning</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter6/1-data_cleaning/">Data cleaning</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter7/"><i class="fas fa-book-reader pr-1"></i>Chapter 7 Metabolite annotation</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter7/1-metid_database_structure/">1 Databases for metID</a></li>



  <li class=""><a href="/zh/docs/chapter7/2-in_house_database/">2 内部MS2数据库</a></li>



  <li class=""><a href="/zh/docs/chapter7/3-construct_public_databases/">3 公共数据库</a></li>



  <li class=""><a href="/zh/docs/chapter7/4-public_databases/">4 公共数据库下载</a></li>



  <li class=""><a href="/zh/docs/chapter7/5-metabolite_annotation/">5 代谢物注释示例</a></li>



  <li class=""><a href="/zh/docs/chapter7/6-identify_single_peak/">6 识别单个峰</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter8/"><i class="fas fa-book-reader pr-1"></i>Chapter 8 Statistical analysis</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter8/1-statistical_analysis/">Statistical analysis</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter9/"><i class="fas fa-book-reader pr-1"></i>Chapter 9 Pathway enrichment</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter9/1-pahtway_enrichment/">Pathway enrichment</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter10/"><i class="fas fa-book-reader pr-1"></i>Chapter 10 Whole workflow using tidymass</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter10/1-whole_workflow/">Whole workflow using tidymass</a></li>

      
        </ul>
      
    

    
      </div>
    



  
    
    
    
    
      
    
    

    
      <div class="docs-toc-item">
        <a class="docs-toc-link " href="/zh/docs/chapter11/"><i class="fas fa-book-reader pr-1"></i>Chapter 11 Some function in tidymass</a>
    
      
        <ul class="nav docs-sidenav">
      


  <li class=""><a href="/zh/docs/chapter11/1-formula/">Formula function</a></li>

      
        </ul>
      
    

    
      </div>
    

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      












      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">在本页</a></li>
      </ul>

      <nav id="TableOfContents">
  <ul>
    <li><a href="#data-preparation">Data preparation</a>
      <ul>
        <li><a href="#positive-mode">Positive mode</a></li>
        <li><a href="#negative-mode">Negative mode</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#session-information">Session information</a></li>
  </ul>
</nav>

      











    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <div class="docs-article-container">
        
          
  <nav class="d-none d-md-flex" aria-label="breadcrumb">
    <ol class="breadcrumb">
      
  
    
  
    
  
    
  

    <li class="breadcrumb-item">
      <a href="/zh/">
        
          Home
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="/zh/docs/">
        
          Preface
        
      </a>
    </li>
  

    <li class="breadcrumb-item">
      <a href="/zh/docs/chapter5/">
        
          Chapter 5 Explore data
        
      </a>
    </li>
  

      <li class="breadcrumb-item active" aria-current="page">
        Explore data
      </li>
    </ol>
  </nav>




        
      </div>

      
      
      

      <div class="docs-article-container">
        
        <h1>Explore data</h1>

        <article class="article-style">

          
          

          <h2 id="data-preparation">Data preparation</h2>
<p>After the <a href="https://tidymass.github.io/tidymass/articles/raw_data_processing.html" target="_blank" rel="noopener"><code>raw data processing</code></a>, peak tables for positive and negative mode have been generated.</p>
<p>Next, we need to get the peak table and sample information and organize them as <code>mass_dataset</code> class objects.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidymass</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Registered S3 method overwritten by &#39;Hmisc&#39;:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   method       from      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   vcov.default fit.models</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ── Attaching packages ──────────────────────────────────────── tidymass 1.0.9 ──</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ massdataset   1.0.34     ✔ metid         1.2.34</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ massprocesser 1.0.10     ✔ masstools     1.0.13</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ masscleaner   1.0.12     ✔ dplyr         1.1.4 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ massqc        1.0.7      ✔ ggplot2       3.5.1 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ massstat      1.0.6      ✔ magrittr      2.0.3 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ metpath       1.0.8</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ forcats   1.0.0     ✔ readr     2.1.5</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ lubridate 1.9.3     ✔ stringr   1.5.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✔ purrr     1.0.2     ✔ tibble    3.2.1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ xcms::collect()          masks dplyr::collect()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ MSnbase::combine()       masks Biobase::combine(), BiocGenerics::combine(), dplyr::combine()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ tidyr::expand()          masks S4Vectors::expand()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ tidyr::extract()         masks magrittr::extract()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ metid::filter()          masks metpath::filter(), dplyr::filter(), massdataset::filter(), stats::filter()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ S4Vectors::first()       masks dplyr::first()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ xcms::groups()           masks dplyr::groups()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ dplyr::lag()             masks stats::lag()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ purrr::map()             masks mixOmics::map()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ BiocGenerics::Position() masks ggplot2::Position(), base::Position()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ purrr::reduce()          masks MSnbase::reduce()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ S4Vectors::rename()      masks dplyr::rename(), massdataset::rename()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ lubridate::second()      masks S4Vectors::second()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ lubridate::second&lt;-()    masks S4Vectors::second&lt;-()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ MASS::select()           masks dplyr::select(), massdataset::select()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ✖ purrr::set_names()       masks magrittr::set_names()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span>
</span></span></code></pre></div><h3 id="positive-mode">Positive mode</h3>
<p>Load <code>object</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">load</span><span class="p">(</span><span class="s">&#34;mzxml_ms1_data/POS/Result/object&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">&lt;-</span> <span class="n">object</span>
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; massdataset version: 0.99.8 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1.expression_data:[ 10149 x 259 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2.sample_info:[ 259 x 4 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 259 samples:sample_06 sample_103 sample_11 ... sample_QC_38 sample_QC_39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3.variable_info:[ 10149 x 3 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 10149 variables:M70T73_POS M70T53_POS M70T183_POS ... M923T55_POS M992T641_POS</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4.sample_info_note:[ 4 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5.variable_info_note:[ 3 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6.ms2_data:[ 0 variables x 0 MS2 spectra]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Processing information</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 processings in total</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; create_mass_dataset ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       Package         Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massdataset create_mass_dataset() 2022-02-23 08:37:06</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; process_data ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;         Package Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massprocesser  process_data 2022-02-23 08:36:42</span>
</span></span></code></pre></div><p>Read sample information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sample_info_pos</span> <span class="o">&lt;-</span> <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;sample_info/sample_info_pos.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Rows: 259 Columns: 6</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ── Column specification ────────────────────────────────────────────────────────</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Delimiter: &#34;,&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; chr (4): sample_id, class, subject_id, group</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; dbl (2): injection.order, batch</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sample_info_pos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; # A tibble: 6 × 6</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   sample_id    injection.order class   batch subject_id  group  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 sample_QC_01               1 QC          1 &lt;NA&gt;        QC     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_01                  2 Subject     1 subject_474 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3 sample_02                  3 Subject     1 subject_431 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_06                  4 Subject     1 subject_414 Case   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_07                  5 Subject     1 subject_830 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6 sample_11                  6 Subject     1 subject_125 Case</span>
</span></span></code></pre></div><p>Add <code>sample_info_pos</code> to <code>object_pos</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">extract_sample_info</span><span class="p">()</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;    sample_id group   class injection.order</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1  sample_06  Case Subject               1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_103  Case Subject               2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3  sample_11  Case Subject               3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_112  Case Subject               4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_117  Case Subject               5</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6  sample_12  Case Subject               6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;group&#34;</span><span class="p">,</span> <span class="s">&#34;class&#34;</span><span class="p">,</span> <span class="s">&#34;injection.order&#34;</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">  <span class="n">object_pos</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">left_join</span><span class="p">(</span><span class="n">sample_info_pos</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;sample_id&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">extract_sample_info</span><span class="p">()</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;    sample_id injection.order   class batch  subject_id group</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1  sample_06               4 Subject     1 subject_414  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_103              71 Subject     1 subject_330  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3  sample_11               6 Subject     1 subject_125  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_112              78 Subject     1 subject_295  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_117              80 Subject     1 subject_793  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6  sample_12               8 Subject     1 subject_387  Case</span>
</span></span></code></pre></div><p>Save the <code>object_pos</code> in a new folder named as <code>data_cleaning</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">dir.create</span><span class="p">(</span><span class="s">&#34;data_cleaning/POS&#34;</span><span class="p">,</span> <span class="n">showWarnings</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">recursive</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">object_pos</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;data_cleaning/POS/object_pos&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_pos</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; massdataset version: 0.99.8 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1.expression_data:[ 10149 x 259 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2.sample_info:[ 259 x 6 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 259 samples:sample_06 sample_103 sample_11 ... sample_QC_38 sample_QC_39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3.variable_info:[ 10149 x 3 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 10149 variables:M70T73_POS M70T53_POS M70T183_POS ... M923T55_POS M992T641_POS</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4.sample_info_note:[ 6 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5.variable_info_note:[ 3 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6.ms2_data:[ 0 variables x 0 MS2 spectra]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Processing information</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 processings in total</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; create_mass_dataset ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       Package         Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massdataset create_mass_dataset() 2022-02-23 08:37:06</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; process_data ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;         Package Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massprocesser  process_data 2022-02-23 08:36:42</span>
</span></span><span class="line"><span class="cl"><span class="nf">dim</span><span class="p">(</span><span class="n">object_pos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; variables   samples </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;     10149       259</span>
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">class</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;     class   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1      QC  39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 Subject 220</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;     group   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1    Case 110</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 Control 110</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3      QC  39</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   batch   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1     1 112</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2     2 147</span>
</span></span></code></pre></div><p>So for positive mode, we have 259 samples and 10,149 variables. 220 subject samples and 39 QC samples. 110 control samples and 110 case samples. Two batches in total, 112 samples in batch 1 and 147 in batch 2.</p>
<p>Next, we can get the peak distributation plot of positive mode.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_pos</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">`+`</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">log</span><span class="p">(</span><span class="m">10</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">show_mz_rt_plot</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_size_continuous</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-8-1.png" width="100%" />
<p>We can explore the missing values (mvs) in positive mode data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [1] 785821</span>
</span></span></code></pre></div><p>785,821 mvs in total.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;sample&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  sample_06 sample_103  sample_11 sample_112 sample_117  sample_12 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       4016       2711       4063       2981       2919       3844</span>
</span></span></code></pre></div><p>Missing value number in each sample.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;variable&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  M70T73_POS  M70T53_POS M70T183_POS M70T527_POS M71T695_POS M71T183_POS </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;         129          16         155          54         133         169</span>
</span></span></code></pre></div><p>Missing value number in each variable.</p>
<p>We can use the figure to show the missing value information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_missing_values</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">,</span> <span class="n">show_column_names</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-12-1.png" width="100%" />
<p>Show the mvs in samples.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_sample_missing_values</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">,</span> <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-13-1.png" width="100%" />
<p>Show the mvs in variables</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_variable_missing_values</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">object</span> <span class="o">=</span> <span class="n">object_pos</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">show_x_text</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">show_x_ticks</span> <span class="o">=</span> <span class="kc">FALSE</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_size_continuous</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-14-1.png" width="100%" />
<h3 id="negative-mode">Negative mode</h3>
<p>Load <code>object</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">load</span><span class="p">(</span><span class="s">&#34;mzxml_ms1_data/NEG/Result/object&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">&lt;-</span> <span class="n">object</span>
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; massdataset version: 0.99.8 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1.expression_data:[ 8804 x 259 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2.sample_info:[ 259 x 4 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 259 samples:sample_06 sample_103 sample_11 ... sample_QC_38 sample_QC_39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3.variable_info:[ 8804 x 3 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 8804 variables:M70T712_NEG M70T527_NEG M70T587_NEG ... M941T65_NEG M948T641_NEG</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4.sample_info_note:[ 4 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5.variable_info_note:[ 3 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6.ms2_data:[ 0 variables x 0 MS2 spectra]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Processing information</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 processings in total</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; create_mass_dataset ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       Package         Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massdataset create_mass_dataset() 2022-02-23 08:38:19</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; process_data ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;         Package Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massprocesser  process_data 2022-02-23 08:38:02</span>
</span></span></code></pre></div><p>Read sample information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sample_info_neg</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="s">&#34;sample_info/sample_info_neg.csv&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Rows: 259 Columns: 6</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ── Column specification ────────────────────────────────────────────────────────</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Delimiter: &#34;,&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; chr (4): sample_id, class, subject_id, group</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; dbl (2): injection.order, batch</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
</span></span><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">sample_info_neg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; # A tibble: 6 × 6</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   sample_id    injection.order class   batch subject_id  group  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   &lt;chr&gt;                  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 sample_QC_01               1 QC          1 &lt;NA&gt;        QC     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_01                  2 Subject     1 subject_474 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3 sample_02                  3 Subject     1 subject_431 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_06                  4 Subject     1 subject_414 Case   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_07                  5 Subject     1 subject_830 Control</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6 sample_11                  6 Subject     1 subject_125 Case</span>
</span></span></code></pre></div><p>Add <code>sample_info_neg</code> to <code>object_neg</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">extract_sample_info</span><span class="p">()</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;    sample_id group   class injection.order</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1  sample_06  Case Subject               1</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_103  Case Subject               2</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3  sample_11  Case Subject               3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_112  Case Subject               4</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_117  Case Subject               5</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6  sample_12  Case Subject               6</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">&lt;-</span> 
</span></span><span class="line"><span class="cl">  <span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;group&#34;</span><span class="p">,</span> <span class="s">&#34;class&#34;</span><span class="p">,</span> <span class="s">&#34;injection.order&#34;</span><span class="p">))</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">&lt;-</span>
</span></span><span class="line"><span class="cl">  <span class="n">object_neg</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">left_join</span><span class="p">(</span><span class="n">sample_info_neg</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;sample_id&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">extract_sample_info</span><span class="p">()</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;    sample_id injection.order   class batch  subject_id group</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1  sample_06               4 Subject     1 subject_414  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 sample_103              71 Subject     1 subject_330  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3  sample_11               6 Subject     1 subject_125  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4 sample_112              78 Subject     1 subject_295  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5 sample_117              80 Subject     1 subject_793  Case</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6  sample_12               8 Subject     1 subject_387  Case</span>
</span></span></code></pre></div><p>Save the <code>object_neg</code> in a new folder named as <code>data_cleaning</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">dir.create</span><span class="p">(</span><span class="s">&#34;data_cleaning/NEG&#34;</span><span class="p">,</span> <span class="n">showWarnings</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">recursive</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">save</span><span class="p">(</span><span class="n">object_neg</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="s">&#34;data_cleaning/NEG/object_neg&#34;</span><span class="p">)</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_neg</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; massdataset version: 0.99.8 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1.expression_data:[ 8804 x 259 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2.sample_info:[ 259 x 6 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 259 samples:sample_06 sample_103 sample_11 ... sample_QC_38 sample_QC_39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3.variable_info:[ 8804 x 3 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 8804 variables:M70T712_NEG M70T527_NEG M70T587_NEG ... M941T65_NEG M948T641_NEG</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 4.sample_info_note:[ 6 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 5.variable_info_note:[ 3 x 2 data.frame]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 6.ms2_data:[ 0 variables x 0 MS2 spectra]</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; -------------------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Processing information</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 processings in total</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; create_mass_dataset ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       Package         Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massdataset create_mass_dataset() 2022-02-23 08:38:19</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; process_data ---------- </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;         Package Function.used                Time</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1 massprocesser  process_data 2022-02-23 08:38:02</span>
</span></span><span class="line"><span class="cl"><span class="nf">dim</span><span class="p">(</span><span class="n">object_neg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; variables   samples </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;      8804       259</span>
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">class</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;     class   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1      QC  39</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 Subject 220</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;     group   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1    Case 110</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2 Control 110</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 3      QC  39</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">activate_mass_dataset</span><span class="p">(</span><span class="n">what</span> <span class="o">=</span> <span class="s">&#34;sample_info&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">count</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   batch   n</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 1     1  86</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; 2     2 173</span>
</span></span></code></pre></div><p>So for negative mode, we have 259 samples and 8,804 variables. 220 subject samples and 39 QC samples. 110 control samples and 110 case samples. Two batches in total, 112 samples in batch 1 and 147 in batch 2.</p>
<p>Next, we can get the peak distributation plot of negative mode.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">object_neg</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">`+`</span><span class="p">(</span><span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">log</span><span class="p">(</span><span class="m">10</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">show_mz_rt_plot</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_size_continuous</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span> <span class="m">2</span><span class="p">))</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-21-1.png" width="100%" />
<p>We can explore the missing values in negitive mode data.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [1] 748253</span>
</span></span></code></pre></div><p>748,253 mvs in total.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;sample&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  sample_06 sample_103  sample_11 sample_112 sample_117  sample_12 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;       3029       2766       3298       3100       2912       3053</span>
</span></span></code></pre></div><p>Missing value number in each sample.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">get_mv_number</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="s">&#34;variable&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span> 
</span></span><span class="line"><span class="cl">  <span class="nf">head</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; M70T712_NEG M70T527_NEG M70T587_NEG  M70T47_NEG M71T587_NEG M71T641_NEG </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;          16         137           2         146          41          19</span>
</span></span></code></pre></div><p>Missing value number in each variable.</p>
<p>We can use the figure to show the missing value information.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_missing_values</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">,</span> <span class="n">show_column_names</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-25-1.png" width="100%" />
<p>Show the mvs in samples.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_sample_missing_values</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">,</span> <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-26-1.png" width="100%" />
<p>Show the mvs in variables.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">show_variable_missing_values</span><span class="p">(</span><span class="n">object</span> <span class="o">=</span> <span class="n">object_neg</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                             <span class="n">percentage</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                             <span class="n">show_x_text</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                             <span class="n">show_x_ticks</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_size_continuous</span><span class="p">(</span><span class="n">range</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.01</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>
</span></span></code></pre></div><img src="/zh/docs/chapter5/1-data_explore_files/figure-html/unnamed-chunk-27-1.png" width="100%" />
<h2 id="conclusion">Conclusion</h2>
<p>So from those exploration, we have a brief summary of our data. Next, we will use <a href="https://tidymass.github.io/masscleaner/" target="_blank" rel="noopener"><code>masscleaner</code> pacakge</a> to do the data cleaning of data.</p>
<h2 id="session-information">Session information</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sessionInfo</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; R version 4.4.1 (2024-06-14)</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Platform: aarch64-apple-darwin20</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Running under: macOS 15.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; Matrix products: default</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; locale:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; time zone: Asia/Singapore</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; tzcode source: internal</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; attached base packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [1] grid      stats4    stats     graphics  grDevices utils     datasets </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [8] methods   base     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; other attached packages:</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [1] lubridate_1.9.3       forcats_1.0.0         stringr_1.5.1        </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [4] purrr_1.0.2           readr_2.1.5           tibble_3.2.1         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [7] tidyverse_2.0.0       metid_1.2.34          metpath_1.0.8        </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [10] ComplexHeatmap_2.20.0 mixOmics_6.28.0       lattice_0.22-6       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [13] MASS_7.3-61           massstat_1.0.6        tidyr_1.3.1          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [16] ggfortify_0.4.17      massqc_1.0.7          masscleaner_1.0.12   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [19] MSnbase_2.30.1        ProtGenerics_1.36.0   S4Vectors_0.42.1     </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [22] Biobase_2.64.0        BiocGenerics_0.50.0   mzR_2.38.0           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [25] Rcpp_1.0.13           xcms_4.2.3            BiocParallel_1.38.0  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [28] massprocesser_1.0.10  ggplot2_3.5.1         dplyr_1.1.4          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [31] magrittr_2.0.3        masstools_1.0.13      massdataset_1.0.34   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [34] tidymass_1.0.9       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; loaded via a namespace (and not attached):</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   [1] fs_1.6.4                    matrixStats_1.3.0          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   [3] bitops_1.0-8                fit.models_0.64            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   [5] httr_1.4.7                  RColorBrewer_1.1-3         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   [7] doParallel_1.0.17           tools_4.4.1                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;   [9] doRNG_1.8.6                 backports_1.5.0            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [11] utf8_1.2.4                  R6_2.5.1                   </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [13] lazyeval_0.2.2              GetoptLong_1.0.5           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [15] withr_3.0.1                 prettyunits_1.2.0          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [17] gridExtra_2.3               preprocessCore_1.66.0      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [19] cli_3.6.3                   Cairo_1.6-2                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [21] fastDummies_1.7.4           labeling_0.4.3             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [23] sass_0.4.9                  mvtnorm_1.3-1              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [25] robustbase_0.99-4           randomForest_4.7-1.1       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [27] proxy_0.4-27                pbapply_1.7-2              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [29] foreign_0.8-87              rrcov_1.7-6                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [31] MetaboCoreUtils_1.12.0      parallelly_1.38.0          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [33] itertools_0.1-3             limma_3.60.4               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [35] readxl_1.4.3                rstudioapi_0.16.0          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [37] impute_1.78.0               generics_0.1.3             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [39] shape_1.4.6.1               vroom_1.6.5                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [41] zip_2.3.1                   Matrix_1.7-0               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [43] MALDIquant_1.22.3           fansi_1.0.6                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [45] abind_1.4-5                 lifecycle_1.0.4            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [47] yaml_2.3.10                 SummarizedExperiment_1.34.0</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [49] SparseArray_1.4.8           crayon_1.5.3               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [51] PSMatch_1.8.0               KEGGREST_1.44.1            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [53] magick_2.8.4                pillar_1.9.0               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [55] knitr_1.48                  GenomicRanges_1.56.1       </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [57] rjson_0.2.22                corpcor_1.6.10             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [59] codetools_0.2-20            glue_1.7.0                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [61] pcaMethods_1.96.0           data.table_1.16.0          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [63] remotes_2.5.0               MultiAssayExperiment_1.30.3</span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [65] vctrs_0.6.5                 png_0.1-8                  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [67] cellranger_1.1.0            gtable_0.3.5               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [69] cachem_1.1.0                xfun_0.47                  </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [71] openxlsx_4.2.7              S4Arrays_1.4.1             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [73] tidygraph_1.3.1             pcaPP_2.0-5                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [75] ncdf4_1.23                  iterators_1.0.14           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [77] statmod_1.5.0               bit64_4.0.5                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [79] robust_0.7-5                progress_1.2.3             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [81] GenomeInfoDb_1.40.1         rprojroot_2.0.4            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [83] bslib_0.8.0                 affyio_1.74.0              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [85] rpart_4.1.23                colorspace_2.1-1           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [87] DBI_1.2.3                   Hmisc_5.1-3                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [89] nnet_7.3-19                 tidyselect_1.2.1           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [91] bit_4.0.5                   compiler_4.4.1             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [93] MassSpecWavelet_1.70.0      htmlTable_2.4.3            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [95] DelayedArray_0.30.1         plotly_4.10.4              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [97] bookdown_0.40               checkmate_2.3.2            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt;  [99] scales_1.3.0                DEoptimR_1.1-3             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [101] affy_1.82.0                 digest_0.6.37              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [103] rmarkdown_2.28              XVector_0.44.0             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [105] htmltools_0.5.8.1           pkgconfig_2.0.3            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [107] base64enc_0.1-3             MatrixGenerics_1.16.0      </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [109] highr_0.11                  fastmap_1.2.0              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [111] rlang_1.1.4                 GlobalOptions_0.1.2        </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [113] htmlwidgets_1.6.4           UCSC.utils_1.0.0           </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [115] farver_2.1.2                jquerylib_0.1.4            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [117] jsonlite_1.8.8              MsExperiment_1.6.0         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [119] mzID_1.42.0                 RCurl_1.98-1.16            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [121] Formula_1.2-5               GenomeInfoDbData_1.2.12    </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [123] patchwork_1.2.0             munsell_0.5.1              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [125] viridis_0.6.5               MsCoreUtils_1.16.1         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [127] vsn_3.72.0                  furrr_0.3.1                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [129] stringi_1.8.4               ggraph_2.2.1               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [131] zlibbioc_1.50.0             plyr_1.8.9                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [133] parallel_4.4.1              listenv_0.9.1              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [135] ggrepel_0.9.5               Biostrings_2.72.1          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [137] MsFeatures_1.12.0           graphlayouts_1.1.1         </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [139] hms_1.1.3                   Spectra_1.14.1             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [141] circlize_0.4.16             igraph_2.0.3               </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [143] QFeatures_1.14.2            rngtools_1.5.2             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [145] reshape2_1.4.4              XML_3.99-0.17              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [147] evaluate_0.24.0             blogdown_1.19              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [149] BiocManager_1.30.25         tzdb_0.4.0                 </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [151] foreach_1.5.2               missForest_1.5             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [153] tweenr_2.0.3                polyclip_1.10-7            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [155] future_1.34.0               clue_0.3-65                </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [157] ggforce_0.4.2               AnnotationFilter_1.28.0    </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [159] e1071_1.7-14                RSpectra_0.16-2            </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [161] ggcorrplot_0.1.4.1          viridisLite_0.4.2          </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [163] class_7.3-22                rARPACK_0.11-0             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [165] memoise_2.0.1               ellipse_0.5.0              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [167] IRanges_2.38.1              cluster_2.1.6              </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [169] timechange_0.3.0            globals_0.16.3             </span>
</span></span><span class="line"><span class="cl"><span class="c1">#&gt; [171] here_1.0.1</span>
</span></span></code></pre></div>

        </article>

        





        



        
        
        <div class="article-widget">
          
<div class="post-nav">
  
  
</div>

        </div>
        
      </div>

      <div class="body-footer">
        <p>最近更新于 5月 5, 2019</p>

        






  

<p class="edit-page">
  <a href="https://github.com/tidymass/tidymass-website/edit/main/content/docs/chapter5/1-data_explore.md">
    <i class="fas fa-pen pr-2"></i>编辑本页
  </a>
</p>



        


  
  
  

  

  
  <section id="comments">
    
<div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    
    
    
  };
  (function() {
    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
      document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
      return;
    }
    var d = document, s = d.createElement('script'); s.async = true;
    s.src = 'https://' + "blog-at8qrhng8b" + '.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


  </section>
  



        


      </div>

      <footer class="site-footer">
  <hr>

    <div style="display: flex; justify-content: space-between; padding: 20px;">
          
 <div style="flex: 1;">
            </div>
            
    
            <div style="flex: 1;">
  <p style="text-align:left;">
    Find me here:
    <br>
    <i class="fa-brands fa-github"></i> <a href="https://github.com/tidymass" target="_blank" rel="noopener">GitHub</a>
<br>
        <i class="fa-brands fa-weixin"></i> <a href="https://jaspershen.github.io/image/wechat_QR.jpg" target="_blank" rel="noopener">WeChat</a>

    <br>
        <i class="fa-brands fa-twitter"></i> <a href="https://twitter.com/xiaotaoshen1990" target="_blank" rel="noopener">Twitter</a>
        
   <br>
        <i class="fa-solid fa-envelope"></i> <a href="https://jaspershen.github.io/#contact" target="_blank" rel="noopener">Email</a>  
        
        <br>
<i class="fa-solid fa-location-dot"></i> Address: <a href="https://maps.app.goo.gl/hfCpoqgzX7zmuh3h6" target="_blank" rel="noopener">59 Nanyang Dr, Singapore 636921</a>
   
    </p>
            </div>
            
    
            <div style="flex: 1;">
            </div>
            
    
            <div style="flex: 1;">
<script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d=e43qUF1sR8y0B12BqEm-gDwkYxSmbro-n8KEiBINpdY"></script>
            </div>
            
    
            <div style="flex: 1;">
            </div>
    
        </div>
        
      <hr>

      











  
  
  
  
  













  
  <p class="powered-by copyright-license-text">
    © 2022-2023 Xiaotao Shen
  </p>
  




  
  
</footer>

    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  


<script src="/js/vendor-bundle.min.938a3a7554cd9f6602290411f64d2617.js"></script>




  

  
  

  









<script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js" integrity="sha256-aQmOEF2ZD4NM/xt4hthzREIo/2PFkOX/g01WjxEV7Ys=" crossorigin="anonymous"></script>
<script>
  anchors.add();
</script>





  
  <script id="search-hit-fuse-template" type="text/x-template">
    <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
    </div>
  </script>
  
    <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
  









  <script id="dsq-count-scr" src="https://blog-at8qrhng8b.disqus.com/count.js" async></script>




  
  
  
  
  
  
  

















<script id="page-data" type="application/json">{"use_headroom":false}</script>











  
  


<script src="/zh/js/wowchemy.min.a019a8d0a4e912d4764e429825411dad.js"></script>

























</body>
</html>
